const Utils={translations:{es:{'age-title':'Verificación de Edad','age-text':'Este contenido está destinado únicamente para mayores de 18 años. Por favor, confirma tu edad para continuar.','age-confirm':'Soy mayor de 18','age-deny':'Soy menor de 18','access-denied':'Acceso denegado. Debes ser mayor de 18 años para acceder a este contenido.','loading-text':'Cargando...','gallery-title':'Galería くろねこ','load-more':'Cargar más','nav-gallery':'Galería','nav-about':'Acerca','nav-contact':'Contacto','about-title':'Acerca de くろねこ','about-text':'Somos una galería dedicada al arte visual contemporáneo, explorando nuevas fronteras de la expresión creativa.','contact-title':'Contacto','contact-text':'Ponte en contacto con nosotros para más información sobre nuestras obras y exposiciones.','download':'Descargar','zoom':'Zoom','zoom-out':'Reducir','image-desc':'Descripción de la imagen','download-success':'¡Descarga completada!','download-error':'Error en la descarga. Intenta nuevamente.','download-options':'Opciones de descarga','download-restricted':'No se puede descargar directamente debido a restricciones del servidor.','open-tab':'Abrir en nueva pestaña','copy-link':'Copiar enlace','close':'Cerrar','copy-success':'Enlace copiado al portapapeles','copy-error':'Error al copiar el enlace','shop-title':'Tienda くろねこ','shop-subtitle':'Obras exclusivas disponibles para coleccionistas','shop-empty':'No hay productos disponibles en este momento.','nav-shop':'Tienda','view-details':'Ver Detalles','contact':'Contactar','nav-messages':'Mensajes','messages-title':'Mensajes Privados','messages-subtitle':'Comunicación segura P2P encriptada','messages-new':'Nuevo Mensaje','messages-empty':'Selecciona una conversación o inicia un nuevo mensaje.','messages-placeholder':'Escribe tu mensaje...','messages-send':'Enviar','messages-welcome':'Bienvenido,','login-title':'Iniciar Sesión','login-username':'Usuario','login-username-placeholder':'Ingresa tu usuario','login-password':'Contraseña','login-password-placeholder':'Ingresa tu contraseña','login-submit':'Iniciar Sesión','login-no-account':'¿No tienes cuenta?','login-register-link':'Regístrate aquí','register-title':'Crear Cuenta','register-username':'Usuario','register-username-placeholder':'Elige un usuario','register-password':'Contraseña','register-password-placeholder':'Crea una contraseña','register-confirm-password':'Confirmar Contraseña','register-confirm-password-placeholder':'Repite la contraseña','register-submit':'Crear Cuenta','register-have-account':'¿Ya tienes cuenta?','register-login-link':'Inicia sesión aquí','logout':'Cerrar Sesión','notification-success':'Éxito','notification-error':'Error','notification-info':'Información','notification-warning':'Advertencia','search-placeholder':'Buscar...','no-results':'No se encontraron resultados','loading-images':'Cargando imágenes...','loading-products':'Cargando productos...','loading-messages':'Cargando mensajes...','conversation-new':'Nueva conversación','conversation-active':'Activo ahora','conversation-offline':'Desconectado','message-sent':'Enviado','message-delivered':'Entregado','message-read':'Leído','product-price':'Precio','product-available':'Disponible','product-sold':'Vendido','product-negotiable':'Precio negociable','filter-all':'Todos','filter-available':'Disponibles','filter-sold':'Vendidos','sort-newest':'Más recientes','sort-oldest':'Más antiguos','sort-price-low':'Precio: menor a mayor','sort-price-high':'Precio: mayor a menor','error-connection':'Error de conexión','error-server':'Error del servidor','error-timeout':'Tiempo de espera agotado','error-unknown':'Error desconocido','try-again':'Intentar nuevamente','welcome-back':'¡Bienvenido de nuevo!','login-success':'Inicio de sesión exitoso','register-success':'Registro exitoso','logout-success':'Sesión cerrada correctamente','validation-required':'Este campo es requerido','validation-email':'Ingresa un email válido','validation-password-length':'La contraseña debe tener al menos 6 caracteres','validation-passwords-match':'Las contraseñas no coinciden','validation-username-length':'El usuario debe tener al menos 3 caracteres','nav-navigation':'Navegación','nav-settings':'Configuración','nav-security':'Seguridad','nav-preferences':'Preferencias'},en:{'age-title':'Age Verification','age-text':'This content is intended only for users over 18 years old. Please confirm your age to continue.','age-confirm':'I am over 18','age-deny':'I am under 18','access-denied':'Access denied. You must be over 18 years old to access this content.','loading-text':'Loading...','gallery-title':'Gallery くろねこ','load-more':'Load more','nav-gallery':'Gallery','nav-about':'About','nav-contact':'Contact','about-title':'About くろねこ','about-text':'We are a gallery dedicated to contemporary visual art, exploring new frontiers of creative expression.','contact-title':'Contact','contact-text':'Contact us for more information about our works and exhibitions.','download':'Download','zoom':'Zoom','zoom-out':'Zoom Out','image-desc':'Image description','download-success':'Download completed!','download-error':'Download error. Please try again.','download-options':'Download Options','download-restricted':'Cannot download directly due to server restrictions.','open-tab':'Open in new tab','copy-link':'Copy link','close':'Close','copy-success':'Link copied to clipboard','copy-error':'Error copying link','shop-title':'Shop くろねこ','shop-subtitle':'Exclusive works available for collectors','shop-empty':'No products available at the moment.','nav-shop':'Shop','view-details':'View Details','contact':'Contact','nav-messages':'Messages','messages-title':'Private Messages','messages-subtitle':'Secure encrypted P2P communication','messages-new':'New Message','messages-empty':'Select a conversation or start a new message.','messages-placeholder':'Type your message...','messages-send':'Send','messages-welcome':'Welcome,','login-title':'Login','login-username':'Username','login-username-placeholder':'Enter your username','login-password':'Password','login-password-placeholder':'Enter your password','login-submit':'Login','login-no-account':'Don\'t have an account?','login-register-link':'Register here','register-title':'Create Account','register-username':'Username','register-username-placeholder':'Choose a username','register-password':'Password','register-password-placeholder':'Create a password','register-confirm-password':'Confirm Password','register-confirm-password-placeholder':'Repeat your password','register-submit':'Create Account','register-have-account':'Already have an account?','register-login-link':'Login here','logout':'Logout','notification-success':'Success','notification-error':'Error','notification-info':'Information','notification-warning':'Warning','search-placeholder':'Search...','no-results':'No results found','loading-images':'Loading images...','loading-products':'Loading products...','loading-messages':'Loading messages...','conversation-new':'New conversation','conversation-active':'Active now','conversation-offline':'Offline','message-sent':'Sent','message-delivered':'Delivered','message-read':'Read','product-price':'Price','product-available':'Available','product-sold':'Sold','product-negotiable':'Price negotiable','filter-all':'All','filter-available':'Available','filter-sold':'Sold','sort-newest':'Newest','sort-oldest':'Oldest','sort-price-low':'Price: Low to High','sort-price-high':'Price: High to Low','error-connection':'Connection error','error-server':'Server error','error-timeout':'Timeout error','error-unknown':'Unknown error','try-again':'Try again','welcome-back':'Welcome back!','login-success':'Login successful','register-success':'Registration successful','logout-success':'Logout successful','validation-required':'This field is required','validation-email':'Please enter a valid email','validation-password-length':'Password must be at least 6 characters','validation-passwords-match':'Passwords do not match','validation-username-length':'Username must be at least 3 characters','nav-navigation':'Navigation','nav-settings':'Settings','nav-security':'Security','nav-preferences':'Preferences'},ja:{'age-title':'年齢確認','age-text':'このコンテンツは18歳以上の方のみを対象としています。続行するには年齢を確認してください。','age-confirm':'18歳以上です','age-deny':'18歳未満です','access-denied':'アクセスが拒否されました。このコンテンツにアクセスするには18歳以上である必要があります。','loading-text':'読み込み中...','gallery-title':'ギャラリー くろねこ','load-more':'もっと読み込む','nav-gallery':'ギャラリー','nav-about':'について','nav-contact':'お問い合わせ','about-title':'くろねこについて','about-text':'私たちは現代ビジュアルアートに特化したギャラリーで、創造的な表現の新たなフロンティアを探求しています。','contact-title':'お問い合わせ','contact-text':'作品や展示会に関する詳細情報は、お問い合わせください。','download':'ダウンロード','zoom':'ズーム','zoom-out':'ズームアウト','image-desc':'画像の説明','download-success':'ダウンロードが完了しました！','download-error':'ダウンロードエラー。もう一度お試しください。','download-options':'ダウンロードオプション','download-restricted':'サーバーの制限により直接ダウンロードできません。','open-tab':'新しいタブで開く','copy-link':'リンクをコピー','close':'閉じる','copy-success':'リンクをクリップボードにコピーしました','copy-error':'リンクのコピー中にエラーが発生しました','shop-title':'ショップ くろねこ','shop-subtitle':'コレクター向けの限定作品','shop-empty':'現在ご利用可能な商品はありません','nav-shop':'ショップ','view-details':'詳細を見る','contact':'連絡する','nav-messages':'メッセージ','messages-title':'プライベートメッセージ','messages-subtitle':'安全な暗号化P2P通信','messages-new':'新しいメッセージ','messages-empty':'会話を選択するか、新しいメッセージを開始してください。','messages-placeholder':'メッセージを入力...','messages-send':'送信','messages-welcome':'ようこそ、','login-title':'ログイン','login-username':'ユーザー名','login-username-placeholder':'ユーザー名を入力','login-password':'パスワード','login-password-placeholder':'パスワードを入力','login-submit':'ログイン','login-no-account':'アカウントをお持ちでない場合','login-register-link':'こちらで登録','register-title':'アカウント作成','register-username':'ユーザー名','register-username-placeholder':'ユーザー名を選択','register-password':'パスワード','register-password-placeholder':'パスワードを作成','register-confirm-password':'パスワード確認','register-confirm-password-placeholder':'パスワードを再入力','register-submit':'アカウント作成','register-have-account':'既にアカウントをお持ちの場合','register-login-link':'こちらでログイン','logout':'ログアウト','notification-success':'成功','notification-error':'エラー','notification-info':'情報','notification-warning':'警告','search-placeholder':'検索...','no-results':'結果が見つかりませんでした','loading-images':'画像を読み込み中...','loading-products':'商品を読み込み中...','loading-messages':'メッセージを読み込み中...','conversation-new':'新しい会話','conversation-active':'オンライン','conversation-offline':'オフライン','message-sent':'送信済み','message-delivered':'配信済み','message-read':'既読','product-price':'価格','product-available':'在庫あり','product-sold':'売り切れ','product-negotiable':'価格交渉可能','filter-all':'すべて','filter-available':'在庫あり','filter-sold':'売り切れ','sort-newest':'新しい順','sort-oldest':'古い順','sort-price-low':'価格: 安い順','sort-price-high':'価格: 高い順','error-connection':'接続エラー','error-server':'サーバーエラー','error-timeout':'タイムアウトエラー','error-unknown':'不明なエラー','try-again':'再試行','welcome-back':'おかえりなさい！','login-success':'ログイン成功','register-success':'登録成功','logout-success':'ログアウト成功','validation-required':'この項目は必須です','validation-email':'有効なメールアドレスを入力してください','validation-password-length':'パスワードは6文字以上である必要があります','validation-passwords-match':'パスワードが一致しません','validation-username-length':'ユーザー名は3文字以上である必要があります','nav-navigation':'ナビゲーション','nav-settings':'設定','nav-security':'セキュリティ','nav-preferences':'設定'}},escapeHtml:function(unsafe){if(typeof unsafe!=='string')return unsafe;return unsafe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},fetchWithTimeout:async function(url,options={},timeout=10000){const controller=new AbortController();const id=setTimeout(()=>controller.abort(),timeout);try{const response=await fetch(url,{...options,signal:controller.signal});clearTimeout(id);return response}catch(error){clearTimeout(id);throw error}},fetchImageData:async function(scriptUrl){try{const cacheKey='gallery-images-cache';const cacheTime='gallery-images-cache-time';const now=Date.now();const thirtyMinutes=30*60*1000;const cachedData=localStorage.getItem(cacheKey);const cacheTimestamp=localStorage.getItem(cacheTime);if(cachedData&&cacheTimestamp&&(now-parseInt(cacheTimestamp))<thirtyMinutes){return JSON.parse(cachedData)}
const response=await this.fetchWithTimeout(scriptUrl,{method:'GET',headers:{'Accept':'text/plain; charset=utf-8',}},15000);if(!response.ok){throw new Error('Error al cargar datos: '+response.status)}
const textData=await response.text();const lines=textData.split('\n').filter(line=>line.trim()!=='');const imageData=[];for(const line of lines){const parts=line.split('|');if(parts.length>=5){imageData.push({id:parseInt(parts[0])||Date.now()+Math.random(),title:parts[1]||'',description:parts[2]||'',thumbnail:parts[3]||'',fullSize:parts[4]||''})}}
localStorage.setItem(cacheKey,JSON.stringify(imageData));localStorage.setItem(cacheTime,now.toString());return imageData}catch(error){console.error('Error fetching image data:',error);return this.getFallbackImageData()}},getFallbackImageData:function(){return[{id:1,title:"Imagen de ejemplo",description:"Esta es una imagen de ejemplo",thumbnail:"../assets/img/img1.png",fullSize:"../assets/img/img1.png"}]},detectBrowserLanguage:function(){const browserLang=navigator.language||navigator.userLanguage;const langCode=browserLang.split('-')[0];if(this.translations[langCode]){return langCode}
return'es'},updateTexts:function(language){const elements=document.querySelectorAll('[data-lang]');elements.forEach(element=>{const key=element.getAttribute('data-lang');if(this.translations[language]&&this.translations[language][key]){if(element.tagName==='INPUT'||element.tagName==='TEXTAREA'){element.placeholder=this.translations[language][key]}else{element.textContent=this.translations[language][key]}}})},simulateLoading:function(duration=1500){return new Promise(resolve=>{setTimeout(()=>{resolve()},duration)})},handleSmoothScrolling:function(){document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener('click',function(e){e.preventDefault();const href=this.getAttribute('href');if(href&&href!=='#'){const target=document.querySelector(href);if(target){target.scrollIntoView({behavior:'smooth',block:'start'})}}})})},showNotification:function(message,type='info',duration=3000){const existingNotification=document.querySelector('.app-notification');if(existingNotification){existingNotification.remove()}
const notification=document.createElement('div');notification.className=`app-notification app-notification--${type}`;notification.innerHTML=`
            <div class="app-notification__content">
                <span class="app-notification__message">${this.escapeHtml(message)}</span>
                <button class="app-notification__close">&times;</button>
            </div>
        `;document.body.appendChild(notification);setTimeout(()=>{notification.style.transform='translateX(0)'},10);const closeBtn=notification.querySelector('.app-notification__close');closeBtn.addEventListener('click',()=>{closeNotification()});const closeNotification=()=>{notification.style.transform='translateX(400px)';setTimeout(()=>{if(notification.parentNode){notification.remove()}},300)};if(duration>0){setTimeout(closeNotification,duration)}
return closeNotification},debounce:function(func,wait,immediate){let timeout;return function executedFunction(...args){const later=()=>{timeout=null;if(!immediate)func(...args);};const callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func(...args);}},throttle:function(func,limit){let inThrottle;return function(...args){if(!inThrottle){func.apply(this,args);inThrottle=!0;setTimeout(()=>inThrottle=!1,limit)}}},preloadImages:function(urls){return Promise.all(urls.map(url=>{return new Promise((resolve,reject)=>{const img=new Image();img.onload=resolve;img.onerror=reject;img.src=url})}))},formatDate:function(date,format='short'){const d=new Date(date);const options={short:{year:'numeric',month:'short',day:'numeric'},long:{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'}};return d.toLocaleDateString(undefined,options[format]||options.short)},fetchWithRetry:async function(url,options={},maxRetries=3){for(let i=0;i<maxRetries;i++){try{const response=await this.fetchWithTimeout(url,options);if(response.ok)return response;if(i===maxRetries-1)throw new Error(`HTTP ${response.status}`);await new Promise(resolve=>setTimeout(resolve,1000*Math.pow(2,i)))}catch(error){if(i===maxRetries-1)throw error;await new Promise(resolve=>setTimeout(resolve,1000*Math.pow(2,i)))}}},fetchMessages:async function(url,data,method='POST'){try{const response=await this.fetchWithRetry(url,{method:method,headers:{'Content-Type':'application/x-www-form-urlencoded',},body:data},2);return await response.text()}catch(error){console.error('Error fetching messages:',error);throw error}}}